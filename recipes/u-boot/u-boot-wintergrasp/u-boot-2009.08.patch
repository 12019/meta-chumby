diff -Nur u-boot-2009.08.orig//board/freescale/mx28_evk/mx28_evk.c u-boot-2009.08/board/freescale/mx28_evk/mx28_evk.c
--- u-boot-2009.08.orig//board/freescale/mx28_evk/mx28_evk.c	2011-03-17 12:40:51.183779061 +0800
+++ u-boot-2009.08/board/freescale/mx28_evk/mx28_evk.c	2011-04-07 16:20:45.677987863 +0800
@@ -49,7 +49,7 @@
 	{ PINID_SSP0_DATA6, PIN_FUN1, PAD_8MA, PAD_3V3, 1 },
 	{ PINID_SSP0_DATA7, PIN_FUN1, PAD_8MA, PAD_3V3, 1 },
 	{ PINID_SSP0_CMD, PIN_FUN1, PAD_8MA, PAD_3V3, 1 },
-	{ PINID_SSP0_DETECT, PIN_FUN1, PAD_8MA, PAD_3V3, 1 },
+	{ PINID_SSP0_DETECT, PIN_FUN1, PAD_8MA, PAD_3V3, 0 },
 	{ PINID_SSP0_SCK, PIN_FUN1, PAD_8MA, PAD_3V3, 1 },
 };
 
@@ -165,9 +165,15 @@
 
 u32 ssp_mmc_is_wp(struct mmc *mmc)
 {
+
+#if 1
+	return 0;
+#else
 	return (mmc->block_dev.dev == 0) ?
 		pin_gpio_get(PINID_SSP0_GPIO_WP) :
 		pin_gpio_get(PINID_SSP1_GPIO_WP);
+#endif
+
 }
 
 int ssp_mmc_gpio_init(bd_t *bis)
diff -Nur u-boot-2009.08.orig//drivers/net/mxc_fec.c u-boot-2009.08/drivers/net/mxc_fec.c
--- u-boot-2009.08.orig//drivers/net/mxc_fec.c	2011-03-17 12:40:55.027783904 +0800
+++ u-boot-2009.08/drivers/net/mxc_fec.c	2011-04-01 16:28:46.779016738 +0800
@@ -939,6 +939,7 @@
 			printf("got MAC address from IIM: %pM\n", ethaddr);
 			memcpy(dev->enetaddr, ethaddr, 6);
 			fec_set_hwaddr(dev);
+			eth_setenv_enetaddr("ethaddr", ethaddr);
 		}
 	}
 
diff -Nur u-boot-2009.08.orig//fs/ext2/ext2fs.c u-boot-2009.08/fs/ext2/ext2fs.c
--- u-boot-2009.08.orig//fs/ext2/ext2fs.c	2011-03-17 12:40:51.134601956 +0800
+++ u-boot-2009.08/fs/ext2/ext2fs.c	2011-04-01 12:16:59.938015773 +0800
@@ -178,6 +178,7 @@
 uint32_t *indir2_block = NULL;
 int indir2_size = 0;
 int indir2_blkno = -1;
+static unsigned int inode_size;
 
 
 static int ext2fs_blockgroup
@@ -212,7 +213,7 @@
 	unsigned int blkoff;
 
 #ifdef DEBUG
-	printf ("ext2fs read inode %d\n", ino);
+	printf ("ext2fs read inode %d, inode_size %d\n", ino, inode_size);
 #endif
 	/* It is easier to calculate if the first inode is 0.  */
 	ino--;
@@ -222,16 +223,12 @@
 		return (0);
 	}
 
-	inodes_per_block = EXT2_BLOCK_SIZE(data) / __le16_to_cpu(sblock->inode_size);
-
-#ifdef DEBUG
-	printf ("ext2fs read inode blkno %d blkoff %d\n", blkno, blkoff);
-#endif
+	inodes_per_block = EXT2_BLOCK_SIZE(data) / inode_size;
 
 	blkno = __le32_to_cpu (blkgrp.inode_table_id) +
 		(ino % __le32_to_cpu (sblock->inodes_per_group))
 		/ inodes_per_block;
-	blkoff = (ino % inodes_per_block) * __le16_to_cpu (sblock->inode_size);
+	blkoff = (ino % inodes_per_block) * inode_size;
 #ifdef DEBUG
 	printf ("ext2fs read inode blkno %d blkoff %d\n", blkno, blkoff);
 #endif
@@ -367,7 +364,7 @@
 			indir2_size = blksz;
 		}
 		if ((__le32_to_cpu (indir1_block[rblock / perblock]) <<
-		     log2_blksz) != indir1_blkno) {
+		     log2_blksz) != indir2_blkno) {
 			status = ext2fs_devread (__le32_to_cpu(indir1_block[rblock / perblock]) << log2_blksz,
 						 0, blksz,
 						 (char *) indir2_block);
@@ -417,6 +414,36 @@
 		if (blknr < 0) {
 			return (-1);
 		}
+
+                if ((i != (pos / blocksize)) &&
+                    (i != (blockcnt - 1)) &&
+                    blknr)
+                {
+                  #define MAX_CONT_BLK 1000
+
+                  int m, n, p, q;
+
+                  m = i;
+
+                  n = (blockcnt - 1) - m;
+
+                  if (n > MAX_CONT_BLK) n = MAX_CONT_BLK;
+
+                  for (p = 1; p < n; p++)
+                  {
+                    q = ext2fs_read_block(node, m + p);
+
+                    if (q < 0)
+                      return -1;
+
+                    if (q != (blknr + p))
+                      break;
+
+                    blockend += blocksize;
+                    i++;
+                  }
+                }
+
 		blknr = blknr << log2blocksize;
 
 		/* Last block.  */
@@ -447,7 +474,7 @@
 		} else {
 			memset (buf, 0, blocksize - skipfirst);
 		}
-		buf += blocksize - skipfirst;
+		buf += blockend;
 	}
 	return (len);
 }
@@ -752,7 +779,7 @@
 }
 
 
-int ext2fs_ls (char *dirname) {
+int ext2fs_ls (const char *dirname) {
 	ext2fs_node_t dirnode;
 	int status;
 
@@ -772,7 +799,7 @@
 }
 
 
-int ext2fs_open (char *filename) {
+int ext2fs_open (const char *filename) {
 	ext2fs_node_t fdiro = NULL;
 	int status;
 	int len;
@@ -863,6 +890,15 @@
 	if (__le16_to_cpu (data->sblock.magic) != EXT2_MAGIC) {
 		goto fail;
 	}
+	if (__le32_to_cpu(data->sblock.revision_level == 0)) {
+		inode_size = 128;
+	} else {
+		inode_size = __le16_to_cpu(data->sblock.inode_size);
+	}
+#ifdef DEBUG
+	printf("EXT2 rev %d, inode_size %d\n",
+			__le32_to_cpu(data->sblock.revision_level), inode_size);
+#endif
 	data->diropen.data = data;
 	data->diropen.ino = 2;
 	data->diropen.inode_read = 1;
diff -Nur u-boot-2009.08.orig//fs/ext2/Makefile u-boot-2009.08/fs/ext2/Makefile
--- u-boot-2009.08.orig//fs/ext2/Makefile	2011-03-17 12:40:51.134601956 +0800
+++ u-boot-2009.08/fs/ext2/Makefile	2011-03-25 11:06:32.775550439 +0800
@@ -35,7 +35,7 @@
 SRCS	:= $(AOBJS:.o=.S) $(COBJS-y:.o=.c)
 OBJS	:= $(addprefix $(obj),$(AOBJS) $(COBJS-y))
 
-#CPPFLAGS +=
+CFLAGS += -O -fno-forward-propagate
 
 all:	$(LIB) $(AOBJS)
 
diff -Nur u-boot-2009.08.orig//include/configs/mx28_evk.h u-boot-2009.08/include/configs/mx28_evk.h
--- u-boot-2009.08.orig//include/configs/mx28_evk.h	2011-03-17 12:40:52.601265242 +0800
+++ u-boot-2009.08/include/configs/mx28_evk.h	2011-04-01 16:11:55.029114365 +0800
@@ -66,9 +66,9 @@
 #define CONFIG_CMDLINE_TAG
 #define CONFIG_SETUP_MEMORY_TAGS
 #define CONFIG_BOOTDELAY	3
-#define CONFIG_BOOTFILE		"uImage"
+#define CONFIG_BOOTFILE		uImage
 #define CONFIG_BOOTARGS		"console=ttyAM0,115200n8 "
-#define CONFIG_BOOTCOMMAND	"run bootcmd_net"
+#define CONFIG_BOOTCOMMAND	"run bootcmd_mmc"
 #define CONFIG_LOADADDR		0x42000000
 #define CONFIG_SYS_LOAD_ADDR	CONFIG_LOADADDR
 
@@ -76,15 +76,14 @@
  * Extra Environments
  */
 #define	CONFIG_EXTRA_ENV_SETTINGS \
-	"nfsroot=/home/notroot/nfs/rootfs\0" \
-	"bootargs_nfs=setenv bootargs ${bootargs} root=/dev/nfs " \
-		"ip=dhcp nfsroot=${serverip}:${nfsroot},v3,tcp " \
-		"fec_mac=${ethaddr}\0" \
-	"bootcmd_net=run bootargs_nfs; dhcp; bootm\0" \
-	"bootargs_mmc=setenv bootargs ${bootargs} root=/dev/mmcblk0p3 " \
-		"rw rootwait ip=dhcp fec_mac=${ethaddr}\0" \
-	"bootcmd_mmc=run bootargs_mmc; " \
-		"mmc read 0 ${loadaddr} 100 3000; bootm\0" \
+        "autoload=n\0" \
+        "bootargs_mmc=setenv bootargs " \
+                "${bootargs} " \
+                "root=/dev/mmcblk0p2 rw rootwait " \
+                "ip=dhcp fec_mac=${ethaddr} gpmi\0" \
+        "bootcmd_mmc=run bootargs_mmc; " \
+                "ext2load mmc 0:2 ${loadaddr} /boot/${bootfile}; " \
+                "bootm\0" \
 
 /*
  * U-Boot Commands
@@ -114,9 +113,6 @@
 #define CONFIG_CMD_MII
 #define CONFIG_CMD_DHCP
 #define CONFIG_CMD_PING
-#define CONFIG_IPADDR			192.168.1.103
-#define CONFIG_SERVERIP			192.168.1.101
-#define CONFIG_NETMASK			255.255.255.0
 /* Add for working with "strict" DHCP server */
 #define CONFIG_BOOTP_SUBNETMASK
 #define CONFIG_BOOTP_GATEWAY
@@ -135,6 +131,7 @@
 	#define CONFIG_DOS_PARTITION
 	#define CONFIG_CMD_FAT
 	#define CONFIG_SYS_SSP_MMC_NUM 2
+	#define CONFIG_CMD_EXT2
 #endif
 
 /*
@@ -185,7 +182,7 @@
 #elif defined(CONFIG_FSL_ENV_IN_MMC)
 	#define CONFIG_ENV_IS_IN_MMC	1
 	/* Assoiated with the MMC layout defined in mmcops.c */
-	#define CONFIG_ENV_OFFSET               (0x400) /* 1 KB */
+	#define CONFIG_ENV_OFFSET               (0x800 + 512) /* 2 KB  + 512 (MBR + SBMAGIC) */
 	#define CONFIG_ENV_SIZE                 (0x20000 - 0x400) /* 127 KB */
 #else
 	#define CONFIG_ENV_IS_NOWHERE	1
diff -Nur u-boot-2009.08.orig//include/ext2fs.h u-boot-2009.08/include/ext2fs.h
--- u-boot-2009.08.orig//include/ext2fs.h	2011-03-17 12:40:54.327924976 +0800
+++ u-boot-2009.08/include/ext2fs.h	2011-03-25 11:09:00.618228062 +0800
@@ -74,8 +74,8 @@
 
 
 extern int ext2fs_set_blk_dev(block_dev_desc_t *rbdd, int part);
-extern int ext2fs_ls (char *dirname);
-extern int ext2fs_open (char *filename);
+extern int ext2fs_ls (const char *dirname);
+extern int ext2fs_open (const char *filename);
 extern int ext2fs_read (char *buf, unsigned len);
 extern int ext2fs_mount (unsigned part_length);
 extern int ext2fs_close(void);
diff -Nur u-boot-2009.08.orig//lib_arm/eabi_compat.c u-boot-2009.08/lib_arm/eabi_compat.c
--- u-boot-2009.08.orig//lib_arm/eabi_compat.c	2011-03-17 12:40:52.321259618 +0800
+++ u-boot-2009.08/lib_arm/eabi_compat.c	2011-03-23 13:11:19.357106914 +0800
@@ -16,3 +16,8 @@
 	printf("raise: Signal # %d caught\n", signum);
 	return 0;
 }
+
+void __aeabi_unwind_cpp_pr0(void)
+{
+};
+
